variables:
  PIPELINE_NAME: Deploy LDAPain

############################
## JOBS
############################

include:
  - project: 'labo/cicd-templates'
    ref: master
    file:
      - '/templates/build-docker.gitlab-ci.yml'
      - '/templates/deploy-swarm.gitlab-ci.yml'
  - local: ci/pipelines/merge-requests.gitlab-ci.yml
  - local: ci/pipelines/deployment.gitlab-ci.yml

############################
## WORKFLOW
############################

workflow:
  name: $PIPELINE_NAME
  rules:
    - if: $CI_PIPELINE_SOURCE == "web" || $CI_PIPELINE_SOURCE == "merge_request_event"
      when: always
    - when: never
